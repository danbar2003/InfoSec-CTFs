from pwn import *
import arrow
from Crypto.Util.number import long_to_bytes
import time
from sympy import poly, symbols, gcd

e = 3
n = 56751557236771291682484925205552213395017286856788424728477520869245312923063269575813709372701501266411744107612661617541524170940980758483006610928802060405295040733651568454102696982761234303408607315598889877531472782169525357044937048595117628739355131854220684649309005299064732402206958720387916062449

target = remote("0.cloud.chals.io", 33644)

time1 = int(arrow.utcnow().timestamp())
c1 = int(target.recvline())
time.sleep(5)
time2 = int(arrow.utcnow().timestamp())
c2 = int(target.recvline())

x = symbols('x')

def get_plain(c1, c2):
    f1 = poly(x**e - c1).set_modulus(n)
    f2 = poly((x + 5)**e - c2).set_modulus(n)

    return -gcd(f1, f2).coeffs()[-1]

m1 = get_plain(c1,c2)
flag = m1 - time1

print (long_to_bytes(int(flag)))